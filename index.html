<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Landscape Theory — Nichola Roberts</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Instrument+Serif&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Marked.js for Markdown -->
    <link rel="preload" as="fetch" href="./content.md" crossorigin>
    <link rel="preload" as="fetch" href="./guide.md" crossorigin>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="site-header">
        <div class="header-container">
            <div class="header-brand">
                <h1><a href="#" class="title-link">Energy Landscape Theory</a></h1>
                <p class="site-author">Nichola Roberts</p>
            </div>
            
            <nav class="header-nav">
                <button class="nav-button menu-trigger" aria-label="Navigation">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
                <button class="nav-button help-trigger" aria-label="Guide">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                        <circle cx="12" cy="17" r="0.5" fill="currentColor"/>
                    </svg>
                </button>
            </nav>
        </div>
    </header>

    <!-- Floating Font Controls -->
    <div class="floating-font-controls" id="floatingFontControls">
        <button class="plain-text-toggle font-button" aria-label="Plain text">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M6 6h12M6 10h12M6 14h12M6 18h8"/>
            </svg>
        </button>
        <button class="font-button font-decrease" aria-label="Decrease font size">-</button>
        <button class="font-button font-increase" aria-label="Increase font size">+</button>
        <button class="font-button transfer-toggle" aria-label="Transfer data between devices" title="Transfer your notes and progress to another device">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M17 1l4 4-4 4"/>
                <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
                <path d="M7 23l-4-4 4-4"/>
                <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
            </svg>
        </button>
    </div>

    <!-- Custom Scroll Indicator -->
    <div class="scroll-indicator" id="scrollIndicator"></div>

    <!-- Fade overlays -->
    <div class="fade-top"></div>
    <div class="fade-bottom"></div>

    <!-- Navigation Menu -->
    <aside class="nav-menu" id="navMenu">
        <div class="nav-menu-inner">
            <button class="nav-close" aria-label="Close menu">&times;</button>
            <nav class="nav-links">
                <a href="#introduction" class="nav-link" data-section="0">Introduction</a>
                <a href="#energy-landscape" class="nav-link" data-section="1">Energy Landscape</a>
                <a href="#fluctuations" class="nav-link" data-section="2">Fluctuations</a>
                <a href="#energy-limit" class="nav-link" data-section="3">Energy Limit</a>
                <a href="#planning" class="nav-link" data-section="4">Planning</a>
                <a href="#relationships" class="nav-link" data-section="5">Relationships</a>
                <a href="#emotions" class="nav-link" data-section="6">Emotions</a>
                <a href="#emotional-overload" class="nav-link" data-section="7">Emotional Overload</a>
                <a href="#core-beliefs" class="nav-link" data-section="8">Core Beliefs</a>
                <a href="#triggers" class="nav-link" data-section="9">Triggers</a>
                <a href="#emergency-escape-routes" class="nav-link" data-section="10">Emergency Escape Routes</a>
                <a href="#protective-structures" class="nav-link" data-section="11">Protective Structures</a>
                <a href="#erosion" class="nav-link" data-section="12">Erosion</a>
                <a href="#holding-patterns" class="nav-link" data-section="13">Holding Patterns</a>
                <a href="#false-erosion" class="nav-link" data-section="14">False Erosion</a>
            </nav>
        </div>
    </aside>

    <!-- Modal Backdrop -->
    <div class="modal-backdrop" id="modalBackdrop"></div>

    <!-- Help Modal -->
    <div class="help-modal" id="helpModal">
        <div class="help-modal-inner">
            <div class="help-sections"></div>
        </div>
    </div>

    <!-- Transfer Modal -->
    <div class="transfer-modal" id="transferModal">
        <div class="transfer-modal-inner">
            <button class="transfer-close" aria-label="Close transfer">&times;</button>
            
            <div class="transfer-content">
                <!-- Generate Code Button -->
                <button class="transfer-button" id="generateCodeBtn">
                    Generate
                </button>
                
                <!-- Generated Code Result -->
                <div class="transfer-result" id="exportResult" style="display: none;">
                    <div class="transfer-code-display">
                        <div class="code-display" id="transferCode"></div>
                        <button class="copy-code-btn" id="copyCodeBtn">Copy Code</button>
                    </div>
                    <p class="transfer-expiry">Active for 2 hours</p>
                </div>

                <!-- Input Code Section -->
                <div class="transfer-input-section" id="inputSection">
                    <input type="text" id="importCode" class="transfer-code-input" 
                           placeholder="enter transfer code" maxlength="8" 
                           style="text-transform: uppercase">
                    <button class="transfer-button" id="importDataBtn">
                        Import
                    </button>
                </div>
                
                <!-- Import Results -->
                <div class="transfer-result" id="importResult" style="display: none;">
                    <div class="import-success" id="importSuccess" style="display: none;">
                        <h4>✅ Import Successful!</h4>
                        <p>Your data has been transferred successfully.</p>
                        <p class="refresh-note">Refresh the page to see your imported notes and progress.</p>
                    </div>
                    
                    <div class="import-conflicts" id="importConflicts" style="display: none;">
                        <h4>⚠️ Data Conflicts Detected</h4>
                        <p>You already have data on this device. How would you like to handle this?</p>
                        <button class="transfer-button secondary" id="mergeDataBtn">
                            Merge Data (Recommended)
                        </button>
                        <button class="transfer-button danger" id="replaceDataBtn">
                            Replace All Data
                        </button>
                    </div>
                    
                    <div class="import-error" id="importError" style="display: none;">
                        <h4>❌ Import Failed</h4>
                        <p id="importErrorMessage"></p>
                    </div>
                </div>

                <!-- Privacy Note -->
                <p class="privacy-note">Data is encrypted and cannot be accessed by anyone without the code.</p>

                <!-- Delete Local Data Section -->
                <div class="delete-section">
                    <button class="delete-button" id="deleteLocalDataBtn">
                        Delete Local Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main>
        <!-- Hero -->
        <section class="hero">
            <div class="hero-image">
                <img src="images/landscape.png" 
                     alt="Mountain path at golden hour"
                     loading="eager">
            </div>
        </section>

        <!-- Content -->
        <article class="content">
            <section id="introduction" class="content-section" data-section="0">
                <div class="section-inner">
                    <p class="lead">You know the feeling. You just got home from work. It's been a long, hard day. You collapse on the sofa. You don't have the energy for anything. You know you have to cook dinner, to do your washing. But you can't. You can't even begin to think about doing it. You are completely out of energy.</p>
                    
                    <p>Your partner comes over, and asks you how your day was. You snap. You don't mean to. You just can't think about anything right now. You don't have the energy.</p>
                    
                    <p>A lot of actions in life can be explained by not having the energy.</p>
                    
                    <div class="section-reading-time" data-section-index="0">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="energy-landscape" class="content-section" data-section="1">
                <div class="section-inner">
                    <h2>Energy Landscape</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="1">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="fluctuations" class="content-section" data-section="2">
                <div class="section-inner">
                    <h2>Fluctuations</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="2">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="energy-limit" class="content-section" data-section="3">
                <div class="section-inner">
                    <h2>Energy Limit</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="3">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="planning" class="content-section" data-section="4">
                <div class="section-inner">
                    <h2>Planning</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="4">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="relationships" class="content-section" data-section="5">
                <div class="section-inner">
                    <h2>Relationships</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="5">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="emotions" class="content-section" data-section="6">
                <div class="section-inner">
                    <h2>Emotions</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="6">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="emotional-overload" class="content-section" data-section="7">
                <div class="section-inner">
                    <h2>Emotional Overload</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="7">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="core-beliefs" class="content-section" data-section="8">
                <div class="section-inner">
                    <h2>Core Beliefs</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="8">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="triggers" class="content-section" data-section="9">
                <div class="section-inner">
                    <h2>Triggers</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="9">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="emergency-escape-routes" class="content-section" data-section="10">
                <div class="section-inner">
                    <h2>Emergency Escape Routes</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="10">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="protective-structures" class="content-section" data-section="11">
                <div class="section-inner">
                    <h2>Protective Structures</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="11">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="erosion" class="content-section" data-section="12">
                <div class="section-inner">
                    <h2>Erosion</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="12">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="holding-patterns" class="content-section" data-section="13">
                <div class="section-inner">
                    <h2>Holding Patterns</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="13">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="false-erosion" class="content-section" data-section="14">
                <div class="section-inner">
                    <h2>False Erosion</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="14">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>
            
            <!-- Easter Egg: Notes section (hidden until all sections are read) -->
            <section id="notes" class="content-section easter-egg" data-section="15" style="display: none;">
                <div class="section-inner">
                    <h2>Notes</h2>
                    <div class="section-content"></div>
                </div>
            </section>
        </article>
    </main>

    <!-- Simple Reading Time at Bottom -->
    <div class="bottom-reading-time" id="bottomReadingTime">
        <span id="timeRemaining">calculating...</span>
    </div>

    <script src="transfer.js"></script>
    <script src="scripts.js"></script>
</body>
</html>