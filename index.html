<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Landscape Theory ‚Äî Nichola Roberts</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Instrument+Serif&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Marked.js for Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- QR Code will be loaded dynamically when needed -->
</head>
<body>
    <!-- Header -->
    <header class="site-header">
        <div class="header-container">
            <div class="header-brand">
                <h1><a href="#" class="title-link">Energy Landscape Theory</a></h1>
                <p class="site-author">Nichola Roberts</p>
            </div>
            
            <nav class="header-nav">
                <button class="nav-button help-trigger" aria-label="Guide">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M8 8a4 4 0 0 1 8 0c0 2.5-4 4-4 4"/>
                        <circle cx="12" cy="18" r="0.5" fill="currentColor"/>
                    </svg>
                </button>
                <button class="nav-button accessibility-trigger" aria-label="Accessibility controls">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="4" y1="8" x2="20" y2="8"/>
                        <circle cx="8" cy="8" r="2"/>
                        <line x1="4" y1="16" x2="20" y2="16"/>
                        <circle cx="16" cy="16" r="2"/>
                    </svg>
                </button>
                <button class="nav-button menu-trigger" aria-label="Navigation">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
            </nav>
        </div>
    </header>

    <!-- Accessibility Panel -->
    <div class="accessibility-panel" id="accessibilityPanel">
        <div class="accessibility-panel-inner">
            <div class="accessibility-panel-content">
                <button class="plain-text-toggle font-button" aria-label="Plain text">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M6 6h12M6 10h12M6 14h12M6 18h8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <button class="font-button font-decrease" aria-label="Decrease font size">-</button>
            <button class="font-button font-increase" aria-label="Increase font size">+</button>
            <button class="font-button transfer-toggle" aria-label="Transfer data between devices" title="Transfer your notes and progress to another device">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M17 1l4 4-4 4"/>
                    <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
                    <path d="M7 23l-4-4 4-4"/>
                    <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
                </svg>
            </button>
            <button class="notes-toggle font-button" aria-label="Toggle notes mode">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/>
                    <path d="m15 5 4 4"/>
                </svg>
            </button>
            </div>
        </div>
    </div>

    <!-- Custom Scroll Indicator -->
    <div class="scroll-indicator" id="scrollIndicator"></div>

    <!-- Fade overlays -->
    <div class="fade-top"></div>
    <div class="fade-bottom"></div>

    <!-- Navigation Menu -->
    <aside class="nav-menu" id="navMenu">
        <div class="nav-menu-inner">
            <button class="nav-close" aria-label="Close menu">&times;</button>
            <nav class="nav-links">
                <a href="#introduction" class="nav-link" data-section="0">Introduction</a>
                <a href="#energy-landscape" class="nav-link" data-section="1">Energy Landscape</a>
                <a href="#fluctuations" class="nav-link" data-section="2">Fluctuations</a>
                <a href="#energy-limit" class="nav-link" data-section="3">Energy Limit</a>
                <a href="#planning" class="nav-link" data-section="4">Planning</a>
                <a href="#relationships" class="nav-link" data-section="5">Relationships</a>
                <a href="#emotions" class="nav-link" data-section="6">Emotions</a>
                <a href="#emotional-overload" class="nav-link" data-section="7">Emotional Overload</a>
                <a href="#core-beliefs" class="nav-link" data-section="8">Core Beliefs</a>
                <a href="#triggers" class="nav-link" data-section="9">Triggers</a>
                <a href="#emergency-escape-routes" class="nav-link" data-section="10">Emergency Escape Routes</a>
                <a href="#protective-structures" class="nav-link" data-section="11">Protective Structures</a>
                <a href="#erosion" class="nav-link" data-section="12">Erosion</a>
                <a href="#holding-patterns" class="nav-link" data-section="13">Holding Patterns</a>
                <a href="#false-erosion" class="nav-link" data-section="14">False Erosion</a>
            </nav>
        </div>
    </aside>

    <!-- Modal Backdrop -->
    <div class="modal-backdrop" id="modalBackdrop"></div>

    <!-- Help Modal -->
    <div class="help-modal" id="helpModal">
        <div class="help-modal-inner">
            <div class="help-sections"></div>
        </div>
    </div>

    <!-- Transfer Modal -->
    <div class="transfer-modal" id="transferModal">
        <div class="transfer-modal-inner">
            <button class="transfer-close" aria-label="Close transfer">&times;</button>
            
            <div class="transfer-content">
                <h3 class="transfer-title">Transfer data between devices</h3>
                <p class="privacy-note" style="margin-top: 0; margin-bottom: 0;">Only right margin notes are transferred.</p>
                
                <!-- Generate Code Button -->
                <button class="transfer-button" id="generateCodeBtn" style="margin-top: 0;">
                    Generate Code
                </button>
                
                <!-- Generated Code Result -->
                <div class="transfer-result" id="exportResult" style="display: none;">
                    <div class="transfer-methods">
                        <div class="transfer-code-display">
                            <div class="code-display" id="transferCode"></div>
                            <button class="copy-code-btn" id="copyCodeBtn">Copy Code</button>
                        </div>
                        <div class="transfer-qr-section">
                            <div class="qr-code-container" id="qrCodeContainer"></div>
                            <p class="qr-label">Or scan QR code</p>
                        </div>
                    </div>
                    <p class="transfer-expiry">Active for 2 hours</p>
                </div>

                <!-- Input Code Section -->
                <div class="transfer-input-section" id="inputSection">
                    <input type="text" id="importCode" class="transfer-code-input" 
                           placeholder="enter transfer code" maxlength="8" 
                           style="text-transform: uppercase">
                    <button class="transfer-button" id="importDataBtn">
                        Import
                    </button>
                </div>
                
                <!-- Custom Message Display -->
                <div class="transfer-message" id="transferMessage" style="display: none;"></div>
                
                <!-- Import Results -->
                <div class="transfer-result" id="importResult" style="display: none;">
                    <div class="import-success" id="importSuccess" style="display: none;">
                        <h4>‚úÖ Import Successful!</h4>
                        <p>Your data has been transferred successfully.</p>
                        <p class="refresh-note">Refresh the page to see your imported notes and progress.</p>
                    </div>
                    
                    <div class="notes-management" id="notesManagement" style="display: none;">
                        <h4>üìù Import Notes</h4>
                        <p>Imported notes will be added to the left side. Move them right to keep them in your main collection, or delete to remove them.</p>
                        <div class="notes-sides">
                            <div class="notes-left">
                                <h5>Imported Notes (Left)</h5>
                                <div id="importedNotesList"></div>
                            </div>
                            <div class="notes-right">
                                <h5>Keep These (Right)</h5>
                                <div id="keepNotesList"></div>
                            </div>
                        </div>
                        <div class="notes-actions">
                            <button class="transfer-button" id="finishNotesBtn">Finish</button>
                        </div>
                    </div>
                    
                    
                    <div class="import-error" id="importError" style="display: none;">
                        <h4>‚ùå Import Failed</h4>
                        <p id="importErrorMessage"></p>
                    </div>
                </div>

                <!-- Privacy Note -->
                <p class="privacy-note">Data is encrypted and cannot be accessed by anyone without the code.</p>

                <!-- Delete Local Data Section -->
                <div class="delete-section">
                    <button class="delete-button" id="deleteLocalDataBtn">
                        Delete Local Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main>
        <!-- Hero -->
        <section class="hero">
            <div class="hero-image">
                <img src="images/landscape.webp" 
                     alt="Mountain path at golden hour"
                     loading="eager">
            </div>
        </section>

        <!-- Content -->
        <article class="content">
            <section id="introduction" class="content-section" data-section="0">
                <div class="section-inner">
                    <p class="lead">You know the feeling. You just got home from work. It's been a long, hard day. You collapse on the sofa. You don't have the energy for anything. You know you have to cook dinner, to do your washing. But you can't. You can't even begin to think about doing it. You are completely out of energy.</p>
                    
                    <p>Your partner comes over, and asks you how your day was. You snap. You don't mean to. You just can't think about anything right now. You don't have the energy.</p>
                    
                    <p>A lot of actions in life can be explained by not having the energy.</p>
                    
                    <div class="section-reading-time" data-section-index="0">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="energy-landscape" class="content-section" data-section="1">
                <div class="section-inner">
                    <h2>Energy Landscape</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="1">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="fluctuations" class="content-section" data-section="2">
                <div class="section-inner">
                    <h2>Fluctuations</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="2">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="energy-limit" class="content-section" data-section="3">
                <div class="section-inner">
                    <h2>Energy Limit</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="3">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="planning" class="content-section" data-section="4">
                <div class="section-inner">
                    <h2>Planning</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="4">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="relationships" class="content-section" data-section="5">
                <div class="section-inner">
                    <h2>Relationships</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="5">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="emotions" class="content-section" data-section="6">
                <div class="section-inner">
                    <h2>Emotions</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="6">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="emotional-overload" class="content-section" data-section="7">
                <div class="section-inner">
                    <h2>Emotional Overload</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="7">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="core-beliefs" class="content-section" data-section="8">
                <div class="section-inner">
                    <h2>Core Beliefs</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="8">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="triggers" class="content-section" data-section="9">
                <div class="section-inner">
                    <h2>Triggers</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="9">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="emergency-escape-routes" class="content-section" data-section="10">
                <div class="section-inner">
                    <h2>Emergency Escape Routes</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="10">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="protective-structures" class="content-section" data-section="11">
                <div class="section-inner">
                    <h2>Protective Structures</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="11">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="erosion" class="content-section" data-section="12">
                <div class="section-inner">
                    <h2>Erosion</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="12">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="holding-patterns" class="content-section" data-section="13">
                <div class="section-inner">
                    <h2>Holding Patterns</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="13">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>

            <section id="false-erosion" class="content-section" data-section="14">
                <div class="section-inner">
                    <h2>False Erosion</h2>
                    <div class="section-content"></div>
                    <div class="section-reading-time" data-section-index="14">
                        <span class="reading-time-remaining"></span>
                    </div>
                </div>
            </section>
            
            <!-- Easter Egg: Notes section (hidden until 1 hour on site) -->
            <section id="notes" class="content-section easter-egg" data-section="15" style="display: none !important;">
                <div class="section-inner">
                    <h2>Notes</h2>
                    <div class="section-content"></div>
                </div>
            </section>
        </article>
    </main>



    <!-- Simple Reading Time at Bottom -->
    <div class="bottom-reading-time" id="bottomReadingTime">
        <span id="timeRemaining">calculating...</span>
    </div>

    <script src="scripts.js"></script>
    <script src="notes.js"></script>
    <script src="transfer-system.js"></script>
    <script src="transfer-modal.js"></script>
</body>
</html>